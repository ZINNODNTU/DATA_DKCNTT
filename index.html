<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Danh sÃ¡ch sinh viÃªn theo lá»›p</title>
<style>
  body { font-family: Arial; padding: 20px; }
  select { padding: 6px; margin-bottom: 10px; }
  table { border-collapse: collapse; width: 100%; }
  th, td { border: 1px solid #ccc; padding: 6px; text-align: center; }
  th { background: #f2f2f2; }
  .error { color: red; margin-top: 10px; }
  .loading { color: #555; margin-top: 10px; }
</style>
</head>
<body>

<h2>Chá»n lá»›p</h2>

<select id="lopSelect" disabled>
<option value="ALL">ğŸ“‹ Táº¥t cáº£</option>

<option value="22DTH1">22DTH1</option>
<option value="22DTH2">22DTH2</option>
<option value="22DTH3">22DTH3</option>
<option value="22DTH4">22DTH4</option>
<option value="22DTH5">22DTH5</option>
<option value="22DTH6">22DTH6</option>
<option value="22DTH7">22DTH7</option>

<option value="23DTH1">23DTH1</option>
<option value="23DTH2">23DTH2</option>
<option value="23DTH3">23DTH3</option>
<option value="23DTH4">23DTH4</option>
<option value="23DTH5">23DTH5</option>

<option value="24DTH1">24DTH1</option>
<option value="24DTH2">24DTH2</option>
<option value="24DTH3">24DTH3</option>
<option value="24DPM1">24DPM1</option>

<option value="25DTH">25DTH</option>
<option value="25DPM">25DPM</option>
<option value="25DTN">25DTN</option>

</select>
<div id="count" style="margin:10px 0; font-weight:bold;">
ğŸ‘¥ Sá»‘ sinh viÃªn: 0
</div>

<div id="status" class="loading">â³ Äang táº£i dá»¯ liá»‡u...</div>

<table>
  <thead>
    <tr>
      <th>MSSV</th>
      <th>Há» tÃªn</th>
      <th>Lá»›p</th>
      <th>SÄT</th>
    </tr>
  </thead>
  <tbody id="data"></tbody>
</table>

<script>
const url = "https://opensheet.elk.sh/1hd1-8lo1DxPOGrPwizlvcF7xPdyu9_dzvzwyziGjmfE/CÃ¢u tráº£ lá»i biá»ƒu máº«u 1";

let allData = [];

const statusDiv = document.getElementById("status");
const select = document.getElementById("lopSelect");
const countDiv = document.getElementById("count");
const tbody = document.getElementById("data");

// ===== LOAD DATA =====
fetch(url)
  .then(res => {
    if (!res.ok) throw new Error("KhÃ´ng thá»ƒ káº¿t ná»‘i Google Sheet");
    return res.json();
  })
  .then(data => {
    if (!data || data.length === 0) {
      throw new Error("Sheet khÃ´ng cÃ³ dá»¯ liá»‡u");
    }

    allData = data;
    statusDiv.textContent = "âœ… Táº£i dá»¯ liá»‡u thÃ nh cÃ´ng";
    select.disabled = false;

    // Hiá»ƒn thá»‹ máº·c Ä‘á»‹nh: Táº¤T Cáº¢
    renderTable(allData);

    console.log("DÃ²ng Ä‘áº§u tiÃªn:", allData[0]);
  })
  .catch(err => {
    statusDiv.textContent = "âŒ Lá»—i: " + err.message;
    statusDiv.className = "error";
  });

// ===== EVENT SELECT =====
select.addEventListener("change", function () {
  const value = this.value;

  let displayData = [];

  if (value === "ALL") {
    displayData = allData;
  } else {
    displayData = allData.filter(
      row => row["Chi Ä‘oÃ n trá»±c thuá»™c:"] === value
    );
  }

  renderTable(displayData);
});

// ===== RENDER TABLE + COUNT =====
function renderTable(data) {
  tbody.innerHTML = "";

  // Äáº¿m sinh viÃªn
  countDiv.textContent = `ğŸ‘¥ Sá»‘ sinh viÃªn: ${data.length}`;

  if (data.length === 0) {
    tbody.innerHTML = `
      <tr>
        <td colspan="4">KhÃ´ng cÃ³ dá»¯ liá»‡u</td>
      </tr>
    `;
    return;
  }

  data.forEach(row => {
    const tr = document.createElement("tr");

    tr.innerHTML = `
      <td>${row["MÃ£ sá»‘ sinh viÃªn:"] || ""}</td>
      <td>${row["Há» TÃªn:"] || ""}</td>
      <td>${row["Chi Ä‘oÃ n trá»±c thuá»™c:"] || ""}</td>
      <td>${row["Sá»‘ Ä‘iá»‡n thoáº¡i:"] || ""}</td>
    `;

    tbody.appendChild(tr);
  });
}
</script>


</body>
</html>
